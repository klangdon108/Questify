<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Questify</title>
  <link rel="manifest" href="manifest.webmanifest">
  <link rel="apple-touch-icon" href="icons/icon-180.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#081027">
  <!-- Gamer/HUD font -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700;800;900&family=Rajdhani:wght@500;600;700&family=Press+Start+2P&family=Nunito:wght@600;700;800&family=Merriweather+Sans:wght@600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header class="top">
    <div class="brand">
      <div class="title">Questify</div>
      <div class="sub" id="levelLine">Level 1 • 0/100 XP</div>
    </div>

    <div class="stats">
      <div class="pill"><span class="pillLabel">Gold</span><span class="pillVal" id="gold">0</span></div>
      <div class="pill"><span class="pillLabel">SP</span><span class="pillVal" id="skill">0</span></div>
    </div>
  </header>

  <section class="card hud">
    <div class="barWrap" aria-label="XP progress">
      <div class="barFill" id="xpFill" style="width:0%"></div>
      <div class="barShine"></div>
      <div class="barText" id="xpPct">0%</div>
    </div>
    <div class="hudRow hudRow3">
      <div class="hudStat">
        <div class="hudLabel">Lifetime XP</div>
        <div class="hudValue" id="lifetimeXp">0</div>
      </div>
      <div class="hudStat">
        <div class="hudLabel">Lifetime Gold</div>
        <div class="hudValue" id="lifetimeGold">0</div>
      </div>
      <div class="hudStat">
        <div class="hudLabel">Lifetime SP</div>
        <div class="hudValue" id="lifetimeSp">0</div>
      </div>
    </div>
    <div class="hudRow">
      <div class="hudStat">
        <div class="hudLabel">Today</div>
        <div class="hudValue" id="todayXp">0 XP</div>
      </div>
    </div>
  </section>

  <nav class="tabs" aria-label="Navigation tabs">
    <button class="tab active" data-view="today">Today</button>
    <button class="tab" data-view="main">Main</button>
    <button class="tab" data-view="rewards">Rewards</button>
    <button class="tab" data-view="achievements">Achievements</button>
    <button class="tab" data-view="settings">Settings</button>
  </nav>

  <main class="views">
    <section class="view active" id="view-today">
      <div class="viewHeader">
        <h2>Side Quests</h2>
        <button class="btn btnGhost" data-action="openCreate" data-kind="side">+ Add</button>
      </div>
      <div class="hintLine">Tap COMPLETE to earn XP. Button turns GREEN on completion. When maxed, it shows a timer to MIDNIGHT.</div>
      <div id="sideList" class="list"></div>
    </section>

    <section class="view" id="view-main">
      <div class="viewHeader">
        <h2>Main Quests</h2>
        <button class="btn btnGhost" data-action="openCreate" data-kind="main">+ Add</button>
      </div>
      <div class="hintLine">Main quests are one-time objectives. Completing one grants a PLATINUM trophy and stores a completion date.</div>
      <div id="mainList" class="list"></div>
    </section>

    <section class="view" id="view-rewards">
      <div class="viewHeader">
        <h2>Rewards</h2>
        <button class="btn btnGhost" data-action="openCreate" data-kind="reward">+ Add</button>
      </div>
      <div class="hintLine">Buy buttons enable only when you can afford the cost.</div>
      <div id="rewardList" class="list"></div>
    </section>

    <section class="view" id="view-achievements">
      <div class="viewHeader">
        <h2>Achievements</h2>
      </div>
      <div class="hintLine">Side quests upgrade into TROPHIES every 10 completions. Main quests award a PLATINUM trophy when completed.</div>

      <div class="achSectionTitle">Side Quest Trophies</div>
      <div id="badgeList" class="list"></div>

      <div class="achSectionTitle">Main Quest Trophies</div>
      <div id="mainBadgeList" class="list"></div>
    </section>

    <section class="view" id="view-settings">
      <div class="viewHeader">
        <h2>Settings</h2>
      </div>
      <div class="card">
        <div class="row">
          <span>XP per level</span>
          <input id="xpPerLevel" type="number" disabled />
        </div>
        <div class="row">
          <span>Gold per level</span>
          <input id="goldPerLevel" type="text" inputmode="numeric" pattern="[0-9]*" />
        </div>
        <div class="row">
          <span>Skill points per level</span>
          <input id="spPerLevel" type="text" inputmode="numeric" pattern="[0-9]*" />
        </div>
        <button class="btn" id="saveSettings">Save</button>
        <p class="hint">XP required increases by 10% each level. Level-up grants Gold + SP.</p>
      </div>

      <div class="card">
        <div class="row">
          <span>Sound effects</span>
          <button class="btn btnGhost" id="toggleSfx">On</button>
        </div>
        <p class="hint">If iPhone is in silent mode, audio may not play.</p>
      </div>

      <div class="card">
        <div class="row">
          <span>Theme</span>
          <select id="themeSelect"></select>
        </div>
        <p class="hint">Themes change the whole look instantly (colors, fonts, and UI shape). Music is separate so you can mix and match.</p>
      </div>

      <div class="card">
        <div class="row">
          <span>Background music</span>
          <button class="btn btnGhost" id="toggleMusic">On</button>
        </div>
        <div class="row">
          <span>Music track</span>
          <select id="musicSelect"></select>
        </div>
        <p class="hint">Music names come from folder names inside <b>Music/</b>. Put an mp3 in each folder and rebuild <b>Music/index.json</b>.</p>
      </div>
    </section>
  <div id="purchasePop" class="purchasePop" aria-hidden="true"><div class="chip"><div class="icon">✓</div><div id="purchasePopText">PURCHASED</div></div></div>
</main>

  <!-- Modal -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="modalScrim" data-action="closeModal"></div>
    <div class="modalPanel" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
      <div class="modalTop">
        <div class="modalTitle" id="modalTitle">Edit</div>
        <button class="iconBtn" data-action="closeModal" aria-label="Close">
          <svg viewBox="0 0 24 24" fill="none"><path d="M6 6l12 12M18 6L6 18" stroke="currentColor" stroke-width="2" stroke-linecap="round"/></svg>
        </button>
      </div>

      <div class="modalBody" id="modalBody"></div>

      <div class="modalActions">
        <button class="btn btnGhost danger" id="modalDelete" style="display:none">Delete</button>
        <div class="spacer"></div>
        <button class="btn btnGhost" data-action="closeModal">Cancel</button>
        <button class="btn" id="modalSave">Save</button>
      </div>
      <div class="modalHint" id="modalHint"></div>
    </div>
  </div>

  <div id="celebration" class="celebration" aria-hidden="true"><div class="celebrateInner"><div class="celebrateTitle">LEVEL UP</div><div class="celebrateSub">NEW POWER UNLOCKED</div><div class="celebrateRays" aria-hidden="true"></div><div class="celebrateParticles" id="celebrateParticles" aria-hidden="true"></div></div></div>
<div class="toast" id="toast" role="status" aria-live="polite"></div>

  <script src="app.js"></script>

<div id="confirmOverlay" class="modalOverlay" aria-hidden="true" style="display:none;">
  <div class="modal" role="dialog" aria-modal="true" aria-labelledby="confirmTitle">
    <div class="modalTop">
      <div class="modalTitle" id="confirmTitle">CONFIRM RESET</div>
      <button class="iconBtn" id="confirmClose" aria-label="Close">✕</button>
    </div>
    <div class="modalBody">
      <p class="hint" style="margin-top:0">This will erase ALL Questify data on this device. Type <b>CONFIRM</b> to continue.</p>
      <div class="field">
        <label for="confirmInput">Type CONFIRM</label>
        <input id="confirmInput" type="text" autocomplete="off" autocapitalize="characters" />
      </div>
      <div class="row" style="gap:10px">
        <button class="btn" id="confirmCancel">Cancel</button>
        <button class="btn danger" id="confirmDoReset" disabled>RESET</button>
      </div>
    </div>
  </div>
</div>
</body>
</html>
